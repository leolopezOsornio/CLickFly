"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8739],{8739:(y,p,c)=>{c.r(p),c.d(p,{InicioPageModule:()=>j});var m=c(177),h=c(4341),i=c(4742),f=c(786),d=c(467),g=c(7691),e=c(4438),_=c(4303);function C(t,l){if(1&t&&(e.j41(0,"div"),e.nrm(1,"img",9),e.k0s()),2&t){const a=e.XpG();e.R7$(),e.Y8G("src",a.imagenUrl,e.B4B)}}let b=(()=>{var t;class l{constructor(n,o,r,s,u){this.modalController=n,this.authService=o,this.cd=r,this.actionSheetController=s,this.loadingController=u,this.correo={},this.imagenUrl=null,this.imagenBase64=null,this.isLargeScreen=!1,this.isLargeScreen=window.innerWidth>=765}updateScreenSize(){this.isLargeScreen=window.innerWidth>=765}ngOnInit(){this.correo&&this.correo.imagen&&(this.imagenUrl=this.correo.imagen)}closeModal(){this.modalController.dismiss()}updateCorreo(){var n=this;return(0,d.A)(function*(){const o=yield n.loadingController.create({message:"Guardando...",spinner:"crescent"});yield o.present();try{n.authService.updateCorreo(n.correo).subscribe({next:(r=(0,d.A)(function*(s){n.authService.mostrarToast(s.message,"success"),yield o.dismiss(),n.closeModal()}),function(u){return r.apply(this,arguments)}),error:function(){var r=(0,d.A)(function*(s){n.authService.mostrarToast(s.error.message||"Error al guardar","danger"),yield o.dismiss()});return function(u){return r.apply(this,arguments)}}()})}catch(r){console.error("Error al actualizar el correo:",r),yield o.dismiss()}var r})()}seleccionarImagen(){var n=this;return(0,d.A)(function*(){yield(yield n.actionSheetController.create({header:"Seleccionar imagen",buttons:[{text:"Tomar una foto",icon:"camera",handler:()=>n.obtenerImagen(g.ru.Camera)},{text:"Elegir de la galer\xeda",icon:"image",handler:()=>n.obtenerImagen(g.ru.Photos)},{text:"Cancelar",icon:"close",role:"cancel"}]})).present()})()}obtenerImagen(n){var o=this;return(0,d.A)(function*(){try{const r=yield g.i7.getPhoto({quality:90,allowEditing:!1,resultType:g.LK.Base64,source:n});r.base64String&&(o.imagenBase64=r.base64String,o.correo.imagen=`data:image/jpeg;base64,${r.base64String}`,o.imagenUrl=o.correo.imagen)}catch(r){o.authService.mostrarToast("No se pudo seleccionar la imagen","danger"),console.error("Error al seleccionar imagen:",r)}})()}isEmailValid(){return/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/.test(this.correo.correo)}isFormValid(){return this.isEmailValid()&&""!==this.correo.nombre&&""!==this.correo.nota}}return(t=l).\u0275fac=function(n){return new(n||t)(e.rXU(i.W3),e.rXU(_.u),e.rXU(e.gRc),e.rXU(i.GD),e.rXU(i.Xi))},t.\u0275cmp=e.VBU({type:t,selectors:[["app-editar"]],hostBindings:function(n,o){1&n&&e.bIt("resize",function(s){return o.updateScreenSize(s)},!1,e.tSv)},inputs:{correo:"correo"},decls:26,vars:6,consts:[[3,"ngClass"],["slot","end"],[3,"click"],["position","floating"],["type","email",3,"ionInput","value"],[3,"ionInput","value"],[4,"ngIf"],["expand","full","color","primary",3,"click"],["expand","full","color","success",3,"click","disabled"],["alt","Imagen del correo",2,"width","30%","height","auto",3,"src"]],template:function(n,o){1&n&&(e.j41(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title"),e.EFF(3,"Editar Correo"),e.k0s(),e.j41(4,"ion-buttons",1)(5,"ion-button",2),e.bIt("click",function(){return o.closeModal()}),e.EFF(6,"Cerrar"),e.k0s()()()(),e.j41(7,"ion-content")(8,"ion-item")(9,"ion-label",3),e.EFF(10,"Correo"),e.k0s(),e.j41(11,"ion-input",4),e.bIt("ionInput",function(s){return o.correo.correo=s.target.value}),e.k0s()(),e.j41(12,"ion-item")(13,"ion-label",3),e.EFF(14,"Nombre"),e.k0s(),e.j41(15,"ion-input",5),e.bIt("ionInput",function(s){return o.correo.nombre=s.target.value}),e.k0s()(),e.j41(16,"ion-item")(17,"ion-label",3),e.EFF(18,"Nota"),e.k0s(),e.j41(19,"ion-input",5),e.bIt("ionInput",function(s){return o.correo.nota=s.target.value}),e.k0s()(),e.j41(20,"ion-item"),e.DNE(21,C,2,1,"div",6),e.j41(22,"ion-button",7),e.bIt("click",function(){return o.seleccionarImagen()}),e.EFF(23," Cambiar Imagen "),e.k0s()(),e.j41(24,"ion-button",8),e.bIt("click",function(){return o.updateCorreo()}),e.EFF(25," Actualizar Correo "),e.k0s()()),2&n&&(e.R7$(),e.Y8G("ngClass",o.isLargeScreen?"":"espacio_css"),e.R7$(10),e.Y8G("value",o.correo.correo),e.R7$(4),e.Y8G("value",o.correo.nombre),e.R7$(4),e.Y8G("value",o.correo.nota),e.R7$(2),e.Y8G("ngIf",o.imagenUrl),e.R7$(3),e.Y8G("disabled",!o.isFormValid()))},dependencies:[i.bv,i.Jm,i.QW,i.W9,i.eU,i.$w,i.uz,i.he,i.BC,i.ai,i.Gw,m.MD,m.YU,m.bT],encapsulation:2}),l})();function I(t,l){if(1&t&&(e.j41(0,"div"),e.nrm(1,"img",4),e.k0s()),2&t){const a=e.XpG();e.R7$(),e.Mz_("alt","Imagen de ",a.correo.nombre,""),e.Y8G("src",a.correo.imagen,e.B4B)}}function E(t,l){1&t&&(e.j41(0,"div")(1,"h3"),e.EFF(2,"Ubicaci\xf3n:"),e.k0s(),e.nrm(3,"div",5),e.k0s())}let v=(()=>{var t;class l{constructor(n){this.modalController=n,this.mapContainer=null}cerrarModal(){this.modalController.dismiss()}ngOnInit(){setTimeout(()=>{this.loadMap()},2e3)}loadMap(){var n=this;return(0,d.A)(function*(){const o=Number(n.correo.latitud),r=Number(n.correo.longitud);isNaN(o)||isNaN(r)?console.error("Coordenadas inv\xe1lidas:",o,r):(n.mapContainer=document.getElementById("mapID"),n.mapContainer?(n.mapContainer.innerHTML="",n.mapContainer.innerHTML=`\n      <iframe\n        width="100%"\n        height="400px"\n        frameborder="0"\n        src="https://maps.google.com/maps?q=${o},${r}&z=15&output=embed"\n        allowfullscreen>\n      </iframe>`):console.error("Contenedor del mapa no encontrado."))})()}}return(t=l).\u0275fac=function(n){return new(n||t)(e.rXU(i.W3))},t.\u0275cmp=e.VBU({type:t,selectors:[["app-modal"]],inputs:{correo:"correo"},decls:26,vars:9,consts:[["slot","end"],[3,"click"],[1,"correo-detalle"],[4,"ngIf"],[1,"correo-imagen",2,"width","35%","height","auto",3,"src","alt"],["id","mapID"]],template:function(n,o){1&n&&(e.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),e.EFF(3,"Detalles del Correo"),e.k0s(),e.j41(4,"ion-buttons",0)(5,"ion-button",1),e.bIt("click",function(){return o.cerrarModal()}),e.EFF(6,"Cerrar"),e.k0s()()()(),e.j41(7,"ion-content")(8,"div",2),e.DNE(9,I,2,3,"div",3),e.j41(10,"h2"),e.EFF(11),e.k0s(),e.j41(12,"p")(13,"strong"),e.EFF(14,"Email:"),e.k0s(),e.EFF(15),e.k0s(),e.j41(16,"p")(17,"strong"),e.EFF(18,"Nota:"),e.k0s(),e.EFF(19),e.k0s(),e.j41(20,"p")(21,"strong"),e.EFF(22,"Fecha:"),e.k0s(),e.EFF(23),e.nI1(24,"date"),e.k0s(),e.DNE(25,E,4,0,"div",3),e.k0s()()),2&n&&(e.R7$(9),e.Y8G("ngIf",o.correo.imagen),e.R7$(2),e.JRh(o.correo.nombre),e.R7$(4),e.SpI(" ",o.correo.correo,""),e.R7$(4),e.SpI(" ",o.correo.nota,""),e.R7$(4),e.SpI(" ",e.i5U(24,6,o.correo.date,"short"),""),e.R7$(2),e.Y8G("ngIf",o.correo.latitud&&o.correo.longitud))},dependencies:[i.bv,i.Jm,i.QW,i.W9,i.eU,i.BC,i.ai,m.MD,m.bT,m.vh,h.X1],styles:[".correo-detalle[_ngcontent-%COMP%]{text-align:center;padding:16px}.correo-detalle[_ngcontent-%COMP%]   .correo-imagen[_ngcontent-%COMP%]{width:100%;max-width:300px;border-radius:8px;margin-top:10px}.correo-detalle[_ngcontent-%COMP%]   #mapID[_ngcontent-%COMP%]{width:100%;height:400px;margin-top:10px;border-radius:8px}"]}),l})();var F=c(3656);function M(t,l){if(1&t){const a=e.RV6();e.j41(0,"ion-item",6),e.bIt("click",function(){const o=e.eBV(a).$implicit,r=e.XpG(2);return e.Njj(r.mostrarCorreo(o))}),e.j41(1,"ion-thumbnail",7),e.nrm(2,"img",8),e.k0s(),e.j41(3,"ion-label")(4,"h3"),e.EFF(5),e.k0s(),e.j41(6,"p")(7,"strong"),e.EFF(8,"Email:"),e.k0s(),e.EFF(9),e.k0s(),e.j41(10,"p")(11,"strong"),e.EFF(12,"Nota:"),e.k0s(),e.EFF(13),e.k0s(),e.j41(14,"p")(15,"small"),e.EFF(16),e.nI1(17,"date"),e.k0s()()(),e.j41(18,"ion-button",9),e.bIt("click",function(o){const r=e.eBV(a).$implicit;return e.XpG(2).editarCorreo(r),e.Njj(o.stopPropagation())}),e.EFF(19,"Editar"),e.k0s(),e.j41(20,"ion-button",10),e.bIt("click",function(o){const r=e.eBV(a).$implicit;return e.XpG(2).eliminarCorreo(r._id),e.Njj(o.stopPropagation())}),e.EFF(21,"Eliminar"),e.k0s()()}if(2&t){const a=l.$implicit;e.R7$(2),e.Mz_("alt","Imagen de ",a.nombre,""),e.Y8G("src",a.imagen?a.imagen:"assets/default-image.png",e.B4B),e.R7$(3),e.JRh(a.nombre),e.R7$(4),e.SpI(" ",a.correo,""),e.R7$(4),e.SpI(" ",a.nota,""),e.R7$(3),e.JRh(e.i5U(17,7,a.date,"short"))}}function k(t,l){if(1&t&&(e.j41(0,"ion-list"),e.DNE(1,M,22,10,"ion-item",5),e.k0s()),2&t){const a=e.XpG();e.R7$(),e.Y8G("ngForOf",a.correos)}}function P(t,l){1&t&&(e.j41(0,"p"),e.EFF(1,"No hay correos guardados"),e.k0s())}const x=[{path:"",component:(()=>{var t;class l{constructor(n,o,r,s){this.navCtrl=n,this.authService=o,this.alertController=r,this.modalController=s,this.emails=[],this.newEmail={id:"",destinatario:"",asunto:"",contenido:""},this.emailValid=!0,this.formValid=!1,this.fullName="",this.isTokenValid=!1,this.isModalOpen=!1,this.editingEmail=null,this.isLargeScreen=!1,this.correos=[],this.isLargeScreen=window.innerWidth>=765}ngOnInit(){const n=JSON.parse(localStorage.getItem("usuario")||"null"),o=localStorage.getItem("authToken");n&&o?(this.fullName=n.nombreCompleto,this.isTokenValid=!0,this.loadEmails()):this.navCtrl.navigateBack("/home")}ionViewWillEnter(){this.loadEmails()}loadEmails(){var n=this;return(0,d.A)(function*(){n.authService.traerCorreos().subscribe({next:o=>{localStorage.setItem("correos",JSON.stringify(o)),n.correos=o},error:o=>{console.error("Error al traer los correos:",o),n.cargarCorreosDesdeLocalStorage()}})})()}cargarCorreosDesdeLocalStorage(){const n=localStorage.getItem("correos");n?this.correos=JSON.parse(n):console.log("No hay correos guardados en localStorage")}logout(){localStorage.clear(),this.navCtrl.navigateBack("/home")}editarCorreo(n){var o=this;return(0,d.A)(function*(){const r=yield o.modalController.create({component:b,componentProps:{correo:n}});return r.onDidDismiss().then(s=>{var u;null!==(u=s.data)&&void 0!==u&&u.updated&&o.loadEmails()}),yield r.present()})()}eliminarCorreo(n){var o=this;return(0,d.A)(function*(){var s;yield(yield o.alertController.create({header:"Confirmar eliminaci\xf3n",message:"\xbfEst\xe1s seguro de que quieres eliminar este correo?",buttons:[{text:"Cancelar",role:"cancel"},{text:"Eliminar",handler:(s=(0,d.A)(function*(){o.authService.eliminarCorreo(n).subscribe({next:()=>{o.authService.mostrarToast("Correo eliminado con \xe9xito","success"),o.loadEmails()},error:u=>{console.error("Error al eliminar el correo:",u),o.authService.mostrarToast("Error al eliminar el correo","danger")}})}),function(){return s.apply(this,arguments)})}]})).present()})()}mostrarCorreo(n){var o=this;return(0,d.A)(function*(){return yield(yield o.modalController.create({component:v,componentProps:{correo:n}})).present()})()}}return(t=l).\u0275fac=function(n){return new(n||t)(e.rXU(F.q9),e.rXU(_.u),e.rXU(i.hG),e.rXU(i.W3))},t.\u0275cmp=e.VBU({type:t,selectors:[["app-inicio"]],standalone:!1,decls:12,vars:4,consts:[["noCorreos",""],[3,"translucent"],[1,"contenedor"],[3,"ngClass"],[4,"ngIf","ngIfElse"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],["slot","start"],[3,"src","alt"],["fill","solid",1,"editar_correo",3,"click"],["fill","solid",1,"eliminar_correo",3,"click"]],template:function(n,o){if(1&n&&(e.j41(0,"ion-header",1),e.nrm(1,"ion-toolbar"),e.k0s(),e.j41(2,"ion-content")(3,"main",2),e.nrm(4,"hr"),e.j41(5,"h2",3),e.EFF(6,"\u{1f4e9} "),e.j41(7,"strong"),e.EFF(8,"Correos guardados"),e.k0s()(),e.DNE(9,k,2,1,"ion-list",4)(10,P,2,0,"ng-template",null,0,e.C5r),e.k0s()()),2&n){const r=e.sdS(11);e.Y8G("translucent",!0),e.R7$(5),e.Y8G("ngClass",o.isLargeScreen?"":"espacio_css"),e.R7$(4),e.Y8G("ngIf",o.correos.length>0)("ngIfElse",r)}},dependencies:[m.YU,m.Sq,m.bT,i.Jm,i.W9,i.eU,i.uz,i.he,i.nf,i.Zx,i.ai,m.vh],styles:[".contenedor[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:0;width:100%;max-width:60rem!important;margin:0 auto;box-sizing:border-box}.contenedor[_ngcontent-%COMP%]   .editar_correo[_ngcontent-%COMP%]{--background: #61c81a !important;--color: #fff;margin-left:8px;font-size:10px}.contenedor[_ngcontent-%COMP%]   .eliminar_correo[_ngcontent-%COMP%]{--background: #d61010e1 !important;--color: #fff;margin-left:8px;font-size:10px}.contenedor[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}h2[_ngcontent-%COMP%]{font-size:24px;font-weight:700;color:#333;text-align:center;margin-bottom:16px}ion-list[_ngcontent-%COMP%]{width:100%}ion-item[_ngcontent-%COMP%]{background-color:#f9f9f9;border-radius:8px;margin-bottom:12px;box-shadow:0 2px 4px #0000001a;padding:16px;display:flex;flex-direction:column;justify-content:center;align-items:flex-start}ion-label[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:18px;font-weight:600;margin-bottom:8px}ion-label[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px;color:#555;margin-bottom:4px}ion-label[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:12px;color:#888}ng-template[_ngcontent-%COMP%]{text-align:center;font-size:16px;color:#555;margin-top:16px}@media (max-width: 600px){ion-item[_ngcontent-%COMP%]{padding:12px}ion-label[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:16px}ion-label[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:12px}}@media (max-width: 375px){ion-item[_ngcontent-%COMP%]{padding:10px}ion-label[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:14px}ion-label[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:10px}}"]}),l})()}];let S=(()=>{var t;class l{}return(t=l).\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.$C({type:t}),t.\u0275inj=e.G2t({imports:[f.iI.forChild(x),f.iI]}),l})(),j=(()=>{var t;class l{}return(t=l).\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.$C({type:t}),t.\u0275inj=e.G2t({imports:[m.MD,h.YN,i.bv,S]}),l})()}}]);